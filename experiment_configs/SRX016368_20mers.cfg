binBase: "/home/robp/SoftwareStaging/countseq/build/src"
dataBase: "/scratch/sailfish"
resultBase: "/scratch/sailfish/results/SRX016368"
hg18Base: $dataBase + "/transcript_sets"

BuildIndex : {
                executable : $binBase + "/Sailfish"
                transcriptDB : $hg18Base + "/hg18_20mers/mer_counts_0"
                ifile : $resultBase + "/transcripts_20mers"
                index : $resultBase + "/transcripts_20mers" + ".sfi"
                counts : $resultBase + "/transcripts_20mers" + ".sfc"
                arguments : {
                    "" : "index"
                        "--thash" : $BuildIndex.transcriptDB
                        "--index" : $BuildIndex.ifile
                }
                depends : [ $BuildIndex.transcriptDB ]
                produces : [  $BuildIndex.index, $BuildIndex.counts ]
}

CountKmers : {
            executable : $binBase + "/Sailfish"
                reads :  $dataBase + "/read_sets/SRX016368/*.fastq"
                readcounts : $resultBase + "/readcounts_20mers.sfc"
                arguments : {
                    "" : "count"
                    "--index" : $BuildIndex.ifile
                    "--counts" : $CountKmers.readcounts
                    "--reads" : $CountKmers.reads
                        }
                depends : [ $BuildIndex.index, $BuildIndex.counts, $CountKmers.reads ]
                produces : [ $CountKmers.readcounts ]
}

Sailfish : {
        executable : $binBase + "/Sailfish"
        output : $resultBase + "/SRX016368_20mers.sf"

        arguments : {
                "" : "itopt",
                "--iterations" : "30",
                "--index" : $BuildIndex.ifile,
                "--tgmap" : $hg18Base + "/hg18_refseq.gtf",
                "--counts" : $CountKmers.readcounts,
                "--genes" : $hg18Base + "/hg18_transcripts.fa",
                "--lutfile" : $resultBase + "/hg18LUT_20mers",
                "-o" : $Sailfish.output
                }
        depends : [ $hg18Base + "/hg18_transcripts.fa",
                        $BuildIndex.index,
                        $BuildIndex.counts,
                        $CountKmers.readcounts,
                        $hg18Base + "/hg18_refseq.gtf"],
    produces : [ $Sailfish.output ]
}
